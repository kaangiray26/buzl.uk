<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta
            name="viewport"
            content="width=device-width, initial-scale=1.0, maximum-scale=5"
        />
        <title>Using Webmentions with GitHub Actions</title>
        <link rel="canonical" href="https://www.buzl.uk/" />
        <!-- If you're wondering about what buzluk means, it's just my surname and it literally means "freezer" in Turkish, lol. -->
        <meta name="title" content="buzl.uk" />
        <meta
            name="description"
            content="kaangiray26's blog about software development, technology, qualities in life and more"
        />

        <meta property="og:site_name" content="buzl.uk" />
        <meta property="og:title" content="buzl.uk" />
        <meta property="og:type" content="website" />
        <meta property="og:url" content="https://www.buzl.uk/" />
        <meta
            property="og:description"
            content="kaangiray26's blog about software development, technology, qualities in life and more"
        />
        <meta
            property="og:image"
            content="https://kaangiray26.github.io/images/buzluk.png"
        />

        <meta property="twitter:card" content="summary" />
        <meta property="twitter:url" content="https://www.buzl.uk/" />
        <meta property="twitter:title" content="Buzl.uk" />
        <meta
            property="twitter:description"
            content="kaangiray26's personal website"
        />
        <meta
            property="twitter:image"
            content="https://kaangiray26.github.io/images/buzluk.png"
        />
        <!-- The icon I ripped from the internet. I'm sorry. -->
        <link
            rel="shortcut icon"
            type="image/svg+xml"
            href="/assets/favicon.svg"
        />
        <link rel="stylesheet" href="/assets/restyle.css" />
        <!-- A RSS feed of course! -->
        <link
            rel="alternate"
            type="application/rss+xml"
            href="https://www.buzl.uk/feed.xml"
            title="buzl.uk"
        />
        <!-- These are my social profiles: -->
        <link href="https://github.com/kaangiray26" rel="me" />
        <link href="https://mastodon.social/@kaangiray26" rel="me" />
        <!-- This is for webmentions: -->
        <link
            rel="webmention"
            href="https://webmention.io/www.buzl.uk/webmention"
        />
        <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Using Webmentions with GitHub Actions | buzl.uk</title>
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="Using Webmentions with GitHub Actions" />
<meta name="author" content="kaangiray26" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Testing webmentions for the first time. This post will send a webmention to another post on my blog. Let’s see if it works." />
<meta property="og:description" content="Testing webmentions for the first time. This post will send a webmention to another post on my blog. Let’s see if it works." />
<link rel="canonical" href="https://www.buzl.uk/2024/08/22/webmentions.html" />
<meta property="og:url" content="https://www.buzl.uk/2024/08/22/webmentions.html" />
<meta property="og:site_name" content="buzl.uk" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2024-08-22T00:00:00+02:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Using Webmentions with GitHub Actions" />
<meta name="twitter:site" content="@kaangiray26" />
<meta name="twitter:creator" content="@kaangiray26" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"kaangiray26"},"dateModified":"2024-08-22T00:00:00+02:00","datePublished":"2024-08-22T00:00:00+02:00","description":"Testing webmentions for the first time. This post will send a webmention to another post on my blog. Let’s see if it works.","headline":"Using Webmentions with GitHub Actions","mainEntityOfPage":{"@type":"WebPage","@id":"https://www.buzl.uk/2024/08/22/webmentions.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://www.buzl.uk/assets/favicon.svg"},"name":"kaangiray26"},"url":"https://www.buzl.uk/2024/08/22/webmentions.html"}</script>
<!-- End Jekyll SEO tag -->

    </head>

    <body>
        <header>
    <div class="frontmatter">
        <a href="/">
            <img src="/assets/favicon.svg" />
            <h1>buzl.uk</h1>
        </a>
    </div>
    <nav>
        <a href="/">Home</a>
        <a href="/blog/">Blog</a>
        <a href="/gallery">Gallery</a>
        <a href="/contact">Contact</a>
        <a href="/now">Now</a>
        <a href="/links">Links</a>
        <kbd>Alt 1-6</kbd>
    </nav>
    <search>
        <form action="/search.html" method="get">
            <kbd>Ctrl K</kbd>
            <input
                type="search"
                name="q"
                placeholder="Type something to search..."
                autocomplete="off"
            />
            <button type="submit">Search</button>
        </form>
    </search>
</header>
<script type="module">
window.addEventListener("load", () => {
    // Add keyboard shortcuts
    document.onkeydown = (e) => {
        // Ctrl + K to focus on search input
        if (e.ctrlKey && e.key === "k") {
            e.preventDefault();
            document.querySelector("input[type=search]").focus();
            return;
        }

        // Alt + 1 to go to home
        if (e.altKey && e.key === "1") {
            e.preventDefault();
            window.location.href = "/";
            return;
        }

        // Alt + 2 to go to blog
        if (e.altKey && e.key === "2") {
            e.preventDefault();
            window.location.href = "/blog";
            return;
        }

        // Alt + 3 to go to gallery
        if (e.altKey && e.key === "3") {
            e.preventDefault();
            window.location.href = "/gallery";
            return;
        }

        // Alt + 4 to go to contact
        if (e.altKey && e.key === "4") {
            e.preventDefault();
            window.location.href = "/contact";
            return;
        }

        // Alt + 5 to go to now
        if (e.altKey && e.key === "5") {
            e.preventDefault();
            window.location.href = "/now";
            return;
        }

        // Alt + 6 to go to links
        if (e.altKey && e.key === "6") {
            e.preventDefault();
            window.location.href = "/links";
            return;
        }
    };

    // Check current page and add active class to the corresponding link
    const currentPath = window.location.pathname;
    for (const link of document.querySelectorAll("nav a")) {
        if (link.getAttribute("href") === currentPath) {
            link.classList.add("active");
            break;
        }
    }
});
</script>
        <main><script defer src="/assets/scripts/post.js"></script>
<style>
    main img{
        cursor: pointer;
    }

    main img:hover{
        filter: brightness(0.9);
    }

    dialog img{
        width: 100%;
        height: auto;
        filter: none !important;
    }
</style>

<h1 class="post-title">Using Webmentions with GitHub Actions</h1>
<p></p>

<!-- Meta -->
<div class="post-author">
    <img src="/assets/spaghetti.webp" />
    <div>
        <p>
            <span>By kaangiray26</span>
        </p>
        <p>
            <time datetime="2024-08-22T00:00:00+02:00">
                Aug 22, 2024
            </time>
        </p>
    </div>
</div>

<!-- Divider -->
<hr />

<!-- Content -->
<p>Testing webmentions for the first time. This post will send a webmention to <a href="https://www.buzl.uk/2024/08/21/pyright.html">another post</a> on my blog. Let’s see if it works.</p>

<p><strong>Edit:</strong> It worked! I can see the webmention on my other post. Okay, let’s go over how I set this up and how you can do it too.</p>

<h2 id="first-what-are-webmentions">First, what are webmentions?</h2>
<p>Webmention is another web standard recommendation from <a href="https://www.w3.org/TR/webmention/">W3C</a>, that was written by the <a href="https://indieweb.org/Webmention">IndieWeb</a> community. Basically, it describes a way for website owners to notify each other when they link each other’s content on their posts. With Webmention, you can leave comments, likes, reposts, and other interactions on other people’s websites, especially if you use <a href="https://indieweb.org/microformats">microformats</a> with it.</p>

<p>I first learned about it on <a href="https://jamesg.blog/2024/02/19/personal-website-ideas/">James’ Blog</a> and thought it was a pretty new thing. But it turns out, it’s been around since 2016. I guess I’m late to the party.</p>

<p>There are two sides to webmentions: receiving and sending. Let’s start with the easier one.</p>

<h2 id="part-1-receiving">Part 1: Receiving</h2>
<p>Notifications are simple HTTP requests. For that reason, we need a server that listens for incoming pings. I’m using a popular choice called <a href="https://webmention.io/">Webmention.io</a>, created by <a href="https://aaronparecki.com/">Aaron Parecki</a>. It’s one of those precious services that are free and open-source on the web. To set it up, you just create an account on the website, add your domain, and put a link tag on your website’s head section. This is the one I have on my blog:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">"webmention"</span> <span class="na">href=</span><span class="s">"https://webmention.io/www.buzl.uk/webmention"</span><span class="nt">&gt;</span>
</code></pre></div></div>

<p>With this tag, other websites can recognize that we accept webmentions. Showing them on your page is also very easy. I have a little script located at <a href="/assets/scripts/webmentions.js">webmentions.js</a> that fetches the webmentions from the service based on the URL of the post you’re viewing as the target. Then, it adds them to the page as a list and shows them in the DOM. If there are no webmentions, the webmentions section is hidden.</p>

<h2 id="part-2-sending">Part 2: Sending</h2>
<p>Sending webmentions manually is a bit tiresome. When you publish a post with links, for each link, you have to check if they support webmentions, and then send a request to their webmention endpoint containing the <code class="language-plaintext highlighter-rouge">source</code> and <code class="language-plaintext highlighter-rouge">target</code> URLs. Some people use services like <a href="https://webmention.app/">Webmention.app</a> to automate this process, but I wanted to do it myself.</p>

<p>A little bit background about my blog: I use Jekyll as my static site generator, and I host it on GitHub Pages. For the build process, I just use the default GitHub Actions workflow that is recommended by Jekyll. With this setup, I just push some changes and the site is build and deployed automatically.</p>

<p>Now, with GitHub Actions, we can try to automate the webmention sending process. All we have to do is to collect all links from my posts, check the target URLs and find out if they support webmentions, and then send a request to their webmention endpoint. For this, we first take the <code class="language-plaintext highlighter-rouge">sitemap.xml</code> file that is generated by Jekyll and extract all the post URLs from it. These are the URLs of our blog posts. Then, we load each URL and extract all the links from the post.</p>

<p>However, we also need to save the webmentions we sent to avoid processing the same URL multiple times in future runs. For this, after the end of the workflow, we save the URLs as a JSON file as an asset by releasing a new release. We also save the domains that don’t support webmentions to avoid checking them again. This way, we save the state of the workflow and don’t have to check the same URLs again.</p>

<p>For the actual processing part, we have a Python script that does the job. I’m not going to go into the details but it just makes some HTTP requests and parses the HTML with <a href="https://lxml.de/">lxml</a>. It’s not perfect but it does the job for now.</p>

<p>I’ve added the files to a new repository, which you can check out <a href="https://github.com/kaangiray26/webmention">here</a> if you want to adapt it to your own blog. My blog’s source code is also available <a href="https://github.com/kaangiray26/buzl.uk">here</a> if you want to see how I implemented the parts I mentioned above and below.</p>

<p>If you want to use this setup, here are the steps you need to follow:</p>

<section>
  <ol>
    <li>Create an account on Webmention.io and add your domain.</li>
    <li>Add the link tag to your website’s head section.</li>
    <li>Have a <code class="language-plaintext highlighter-rouge">sitemap.xml</code> file on your website.</li>
    <li>Add a <code class="language-plaintext highlighter-rouge">TOKEN</code> secret to your repository with your GitHub token.</li>
    <li>Add the GitHub Actions <a href="https://github.com/kaangiray26/webmention/blob/main/main.yml">workflow</a> to your repository. You don’t have to change anything in it.</li>
    <li>Deploy your website to trigger the workflow.</li>
  </ol>
</section>

<p>That’s it! You should now be able to send webmentions automatically with GitHub Actions. If you have any questions, feel free to ask me, or send me a webmention. I’d love to see if it works for you too.</p>


<!-- Postscript -->


<!-- Image dialog -->
<dialog id="image-dialog" onclick="this.close()">
    <img src="" alt="" />
</dialog>
<webmentions>
    <h3>Webmentions</h3>
</webmentions>
<script src="/assets/scripts/webmentions.js"></script>
</main>
        <footer>
    <a href="feed.xml">RSS</a>
    <p>
        Licensed under the
        <a
            target="_blank"
            href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
            >CC BY-NC-SA 4.0 License</a
        >.
    </p>
    <p>Copyright © <time id="date"></time> Kaan Giray Buzluk</p>
    <img src="/assets/lf1B0.gif" class="mate" />
</footer>

<script type="module">
    window.addEventListener("load", async () => {
        const date = new Date().getFullYear();
        document.getElementById("date").textContent = date;
    });
</script>

    </body>
</html>
